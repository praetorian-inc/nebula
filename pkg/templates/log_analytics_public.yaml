id: log_analytics_public_access
name: Publicly Accessible Log Analytics Workspaces
description: Detects Log Analytics workspaces with public network access enabled for ingestion or query operations. Note that all access still requires Azure AD authentication and appropriate RBAC permissions.
severity: Low
category: ["Public Access", "arg-scan"]
reportability: Manual Triage
triageNotes: |
  Important Context:
  Azure Log Analytics Workspaces do not support unauthenticated or anonymous access. Every query or API call requires authentication through Azure AD and appropriate permission assignments, regardless of public network access settings. There is no Microsoft-supported configuration to enable unauthenticated access to logs.

  Understanding Public Network Access:
  - "Public network access" refers to network-level connectivity, not authentication bypass
  - All access still requires valid Azure AD authentication and RBAC permissions

  Potential Considerations:
  - Increased attack surface through internet-accessible endpoints
  - Consider whether private endpoints would better align with security posture

  Triage Guidance:
  - Validate for mitigating controls (e.g., any IP restrictions or network security groups in place)

  Remediation Considerations:
  - Disable public network access if not required
  - Implement private endpoints for secure connectivity
  - Configure IP allow lists if public access is necessary
  - Review and validate RBAC assignments
references:
  - https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview
  - https://learn.microsoft.com/en-us/azure/azure-monitor/logs/private-link-security
  - https://learn.microsoft.com/en-us/azure/azure-monitor/logs/manage-access
query: |
    resources
    | where type =~ 'Microsoft.OperationalInsights/workspaces'
    | where 
        properties.publicNetworkAccessForIngestion == 'Enabled' or 
        properties.publicNetworkAccessForQuery == 'Enabled'
    | project
        id,
        name,
        type,
        location,
        publicNetworkAccessForIngestion = properties.publicNetworkAccessForIngestion,
        publicNetworkAccessForQuery = properties.publicNetworkAccessForQuery,
        subscriptionId
