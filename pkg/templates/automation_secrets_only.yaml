id: automation_secrets_only
name: Automation Accounts for Secret Detection Testing
category: secrets
description: Finds specific automation accounts for secret detection testing only
severity: High
reportability: Automatic
triageNotes: |
  This template is designed specifically for testing secret detection in automation account variables and runbooks.
  It targets only automation accounts in the test resource groups with known embedded secrets.
references:
  - https://learn.microsoft.com/en-us/azure/automation/
query: |
  resources
  | where type =~ 'Microsoft.Automation/automationAccounts'
  | where resourceGroup in~ ('test-find-secrets-rjwl', 'test-automation-4r7h')
  | project
      id,
      type,
      name,
      location,
      subscriptionId,
      resourceGroup