id: vm_secrets_only
name: Virtual Machines for Secret Detection Testing
category: secrets
description: Finds specific VMs for secret detection testing only
severity: High
reportability: Automatic
triageNotes: |
  This template is designed specifically for testing secret detection in VM user data.
  It targets only VMs in the test resource groups with known embedded secrets.
references:
  - https://learn.microsoft.com/en-us/azure/virtual-machines/
query: |
  resources
  | where type =~ 'Microsoft.Compute/virtualMachines'
  | where resourceGroup in~ ('test-find-secrets-rjwl', 'test-vm-userdata-3hb9')
  | project
      id,
      type,
      name,
      location,
      subscriptionId,
      resourceGroup