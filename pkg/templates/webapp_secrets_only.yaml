id: webapp_secrets_only
name: Web Apps for Secret Detection Testing
category: ["secrets"]
description: Finds specific web apps for secret detection testing only
severity: High
reportability: Automatic
triageNotes: |
  This template is designed specifically for testing secret detection in web app configuration.
  It targets only web apps in the test resource groups with known embedded secrets.
references:
  - https://learn.microsoft.com/en-us/azure/app-service/
query: |
  resources
  | where type in~ ('Microsoft.Web/sites', 'Microsoft.Web/sites/slots')
  | where resourceGroup in~ ('test-find-secrets-rjwl', 'test-webapp-aifx')
  | project
      id,
      type,
      name,
      location,
      subscriptionId,
      resourceGroup