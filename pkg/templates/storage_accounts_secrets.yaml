id: storage_accounts_secrets
name: Storage Accounts for Secret Scanning
description: Discovers Azure Storage accounts for blob content secrets scanning
severity: High
category: ["secrets"]
reportability: Automatic
triageNotes: |
  Storage accounts with accessible blob containers are scanned for secrets.
  Requires Storage Blob Data Reader RBAC role or equivalent.
references:
  - https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction
query: |
  resources
  | where type =~ 'Microsoft.Storage/storageAccounts'
  | project
      id,
      name,
      type,
      location,
      subscriptionId
