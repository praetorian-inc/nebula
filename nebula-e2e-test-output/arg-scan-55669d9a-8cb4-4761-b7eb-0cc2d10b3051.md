# Azure Resource Graph Scan Results

**Scan Date:** 2026-02-10 23:38:28 +08
**Total Findings:** 18

## Summary

| Template Name | Findings Count |
|---------------|----------------|
| Publicly Accessible Event Hub Namespaces | 1 |
| Publicly Accessible Key Vaults | 1 |
| SQL Servers Without Public Access Block | 1 |
| ACR Anonymous Pull Access Enabled | 1 |
| Publicly Accessible Cosmos DB Accounts | 1 |
| Database Azure Services Access Detection | 1 |
| Publicly Accessible Log Analytics Workspaces | 1 |
| Custom Roles with Privilege Escalation Permissions | 1 |
| Publicly Accessible Redis Caches | 2 |
| Publicly Accessible Service Bus Namespaces | 1 |
| Publicly Accessible Storage Accounts | 1 |
| Azure APIM Cross-Tenant Signup Bypass (GHSA-vcwf-73jp-r7mv) | 1 |
| Publicly Accessible App Services | 2 |
| Publicly Accessible Container Registries | 3 |

---

## Publicly Accessible Redis Caches

**Description:** Detects Redis Cache instances with public network access enabled that are not integrated with a virtual network. Note that all access still requires authentication via access keys or Azure AD, as anonymous access is not supported.

**Severity:** Low

**Template ID:** redis_cache_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| redis\-test\-770646550 | microsoft\.cache/redis | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | hostname: redis\-test\-770646550\.redis\.cache\.windows\.net<br>publicNetworkAccess: enabled<br>minimumTlsVersion: 1\.2<br>sku: Basic<br>enableNonSslPort: false | **Command:** nc \-zv redis\-test\-770646550\.redis\.cache\.windows\.net 6380<br>**Description:** Test TCP connectivity to Redis SSL port 6380<br>**Expected:** Connection succeeded = accessible \| Connection failed/timeout = blocked/unreachable<br>**Actual:** Connection successful<br>**Exit Code:** 0<br><br>**Command:** redis\-cli \-h redis\-test\-770646550\.redis\.cache\.windows\.net \-p 6380 \-\-tls \-a 'AZURE\_REDIS\_CACHE\_ACCESS\_KEY' ping<br>**Description:** Test Redis PING command with access key<br>**Expected:** PONG = authentication successful \| WRONGPASS/NOAUTH = authentication required \| Connection error = network/access issue<br>**Actual:** Manual execution required \- requires redis\-cli tool<br>**Exit Code:** 0 |
| redis\-test\-770647364 | microsoft\.cache/redis | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | enableNonSslPort: false<br>minimumTlsVersion: 1\.2<br>hostname: redis\-test\-770647364\.redis\.cache\.windows\.net<br>publicNetworkAccess: enabled<br>sku: Basic | **Command:** nc \-zv redis\-test\-770647364\.redis\.cache\.windows\.net 6380<br>**Description:** Test TCP connectivity to Redis SSL port 6380<br>**Expected:** Connection succeeded = accessible \| Connection failed/timeout = blocked/unreachable<br>**Actual:** Connection successful<br>**Exit Code:** 0<br><br>**Command:** redis\-cli \-h redis\-test\-770647364\.redis\.cache\.windows\.net \-p 6380 \-\-tls \-a 'AZURE\_REDIS\_CACHE\_ACCESS\_KEY' ping<br>**Description:** Test Redis PING command with access key<br>**Expected:** PONG = authentication successful \| WRONGPASS/NOAUTH = authentication required \| Connection error = network/access issue<br>**Actual:** Manual execution required \- requires redis\-cli tool<br>**Exit Code:** 0 |

### Triage Guide

```
Important Context:
Azure Cache for Redis does not support truly anonymous or unauthenticated access. Authentication is always required to connect and use the cache, regardless of public network access settings.

Authentication Methods:
- Access Keys: Shared secret keys that provide full access to the cache
- Microsoft Entra ID (Azure AD) Authentication: Password-free, token-based authentication with RBAC support via Redis Access Control Lists (ACLs)
- Built-in access policies (Data Owner, Data Contributor, Data Reader) can be assigned via Azure RBAC using Microsoft Entra identities
- You cannot disable authentication entirely to allow anonymous access

Understanding Public Network Access:
- "Public network access" refers to network-level connectivity from the internet, not authentication bypass
- All Redis operations still require valid access keys or Azure AD authentication
- Public access means Redis endpoints are reachable from the internet (subject to authentication)
- VNet integration automatically makes the cache non-publicly addressable, regardless of public network access settings

VNet Integration Considerations:
- Redis caches configured with virtual network integration are not publicly addressable
- VNet integration provides network-level isolation and is only available for Premium tier caches
- This scan specifically targets caches WITHOUT VNet integration that have public access enabled

Potential Considerations:
- Increased attack surface through internet-accessible cache endpoints
- Potential for usage of compromised credentials to access Redis cache from Internet

Triage Guidance:
- Validate any mitigating factors (e.g., firewall rules or IP restrictions protecting the cache)

Remediation Considerations:
- Disable public network access if not required for business operations
- Implement VNet integration (requires Premium tier) for secure connectivity
- Configure firewall rules to restrict access to specific IP ranges if public access is necessary

```

### References

- https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-network-isolation
- https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-how-to-premium-vnet
- https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-azure-active-directory-for-authentication

---

## Publicly Accessible Storage Accounts

**Description:** Detects storage accounts with public network access enabled, default allow action, and blob public access not explicitly disabled (null or true). Manual triage of IP rules are necessary.

**Severity:** High

**Template ID:** storage_accounts_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| sttakeovergmeima | microsoft\.storage/storageaccounts | eastus2 | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | allowBlobPublicAccess: true<br>defaultAction: Allow<br>hasVnetRules: 0<br>ipRules: none<br>publicNetworkAccess: Enabled<br>hasIpRules: 0<br>virtualNetworkRules: none | **Command:** curl \-i 'https://sttakeovergmeima\.blob\.core\.windows\.net/?comp=list' \-\-max\-time 3<br>**Description:** Test anonymous access to storage account container listing<br>**Expected:** anonymous access enabled = 404 \| anonymous access disabled = 401/403 \| public access disabled = 409<br>**Actual:** Body: ﻿<?xml version="1\.0" encoding="utf\-8"?\><Error\><Code\>ResourceNotFound</Code\><Message\>The specified resource does not exist\. RequestId:4975467c\-701e\-0018\-5da3\-9ac550000000 Time:2026\-02\-10T15:39:09\.2059961Z</Message\></Error\><br>**Exit Code:** 404 |

### Triage Guide

```
Potential Risk:
- Public accessibility exposes storage endpoints to the entire internet
- Could lead to unauthorized data access attempts
- Potential for data exfiltration if misconfigured

Triage Guidance:
- This finding only confirms the storage account is accessible from the internet and not anonymous access
- This finding does not take into consideration fine-grained IP rules, always check manually if storage account hasIpRules and hasVnetRules is not returning a 0 value
- Additional manual testing is required to determine if anonymous/unauthorized access is possible
- Readers do not have object-level access, some additional permissions or shoulder surfing may be required

```

### References

- https://learn.microsoft.com/en-us/azure/storage/common/storage-network-security

---

## ACR Anonymous Pull Access Enabled

**Description:** Detects Azure Container Registry (ACR) instances with anonymous pull access enabled, allowing unauthenticated users to pull container images without authentication.

**Severity:** High

**Template ID:** acr_anonymous_pull_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| nebulatestpublic37762 | microsoft\.containerregistry/registries | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | loginServer: nebulatestpublic37762\.azurecr\.io<br>anonymousPullEnabled: 1<br>adminUserEnabled: 0<br>publicNetworkAccess: enabled<br>resourceGroup: nebula\-e2e\-acr\-test |  |

### Triage Guide

```
Security Risk:
Azure Container Registry with anonymous pull enabled allows anyone on the internet to pull container images without any authentication. This is a critical security misconfiguration that can lead to:

- Unauthorized access to proprietary container images
- Exposure of secrets, credentials, or sensitive data embedded in images
- Intellectual property theft
- Compliance violations (HIPAA, PCI-DSS, SOC 2)
- Potential for reverse engineering of application logic

Understanding Anonymous Pull:
- Anonymous pull access (anonymousPullEnabled) allows public read access to all images in the registry
- This is different from "public network access" which only controls network-level connectivity
- Even with firewall rules, anonymous pull bypass authentication entirely
- This setting is typically used for open-source projects, NOT production environments

Triage Guidance:
1. Verify if the ACR contains production images or sensitive workloads
2. Check if the registry stores images with embedded secrets, API keys, or credentials
3. Determine if this is intentional for open-source/public container images
4. Review image pull logs to identify if unauthorized access has occurred
5. Validate if network security groups or firewall rules provide any protection (they don't prevent anonymous pull)

Remediation Considerations:
- Disable anonymous pull access immediately for production registries
- Use Azure AD authentication or repository-scoped tokens instead
- Enable admin user only if necessary (not recommended for production)
- Implement network restrictions with private endpoints or VNet integration
- Audit all images for embedded secrets before disabling anonymous access
- Review and rotate any credentials that may have been exposed

Additional Context:
- Anonymous pull is disabled by default on new ACR instances
- This finding indicates explicit configuration or legacy migration
- High severity due to complete authentication bypass

```

### References

- https://learn.microsoft.com/en-us/azure/container-registry/anonymous-pull-access
- https://learn.microsoft.com/en-us/azure/templates/microsoft.containerregistry/registries
- https://learn.microsoft.com/en-us/azure/container-registry/container-registry-authentication

---

## Azure APIM Cross-Tenant Signup Bypass (GHSA-vcwf-73jp-r7mv)

**Description:** Detects Azure API Management instances vulnerable to cross-tenant signup bypass. When signup is disabled in the UI, the underlying API endpoint remains active and attackers can register accounts by directly calling the signup API with a modified Host header. This vulnerability exists regardless of identity provider configuration.

**Severity:** Medium

**Template ID:** apim_cross_tenant_signup_bypass

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| nebula\-vuln\-718112 | microsoft\.apimanagement/service | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | skuName: Developer<br>resourceGroup: nebula\-test\-rg<br>developerPortalStatus: Enabled<br>skuCapacity: 1<br>gatewayUrl: https://nebula\-vuln\-718112\.azure\-api\.net<br>publicNetworkAccess: Enabled<br>developerPortalUrl: https://nebula\-vuln\-718112\.developer\.azure\-api\.net | **Command:** curl \-i 'https://nebula\-vuln\-718112\.developer\.azure\-api\.net' \-\-max\-time 15<br>**Description:** Test if Developer Portal is accessible<br>**Expected:** 200 = portal accessible \| 403 = blocked \| timeout = not reachable<br>**Actual:** Status: 200, Body preview: <p\>This is a home page of the Developer portal \- an automatically generated, fully customizable website for publishing your API documentation where consumers can discover APIs, learn how to use them, request access, and try them out\.</p\> <p\>The content hasn't been published yet\. You can do so in "Developer portal" section of your API Management Service in the Azure portal\. <a href="https://docs\.microsoft\.com/en\-us/azure/api\-management/api\-management\-howto\-developer\-portal" target="\_blank"\> Learn\.\.\.<br>**Exit Code:** 200<br><br>**Command:** curl \-i 'https://nebula\-vuln\-718112\.developer\.azure\-api\.net/signup' \-\-max\-time 15<br>**Description:** Test if signup page is accessible \(UI check\)<br>**Expected:** 200 = signup visible in UI \| 404 = signup hidden in UI \(but API may still work\!\) \| redirect = disabled<br>**Actual:** Status: 200, Body preview: <p\>This is a home page of the Developer portal \- an automatically generated, fully customizable website for publishing your API documentation where consumers can discover APIs, learn how to use them, request access, and try them out\.</p\> <p\>The content hasn't been published yet\. You can do so in "De\.\.\.<br>**Exit Code:** 200<br><br>**Command:** curl \-X POST 'https://nebula\-vuln\-718112\.developer\.azure\-api\.net/signup' \\ \-H 'Content\-Type: application/json' \\ \-H 'Origin: https://nebula\-vuln\-718112\.developer\.azure\-api\.net' \\ \-\-data\-raw '\{"challenge":\{"testCaptchaRequest":\{"challengeId":"00000000\-0000\-0000\-0000\-000000000000","inputSolution":"AAAAAA"\},"azureRegion":"NorthCentralUS","challengeType":"visual"\},"signupData":\{"email":"nebula\-vuln\-probe@nonexistent\-invalid\-domain\.test","firstName":"Nebula","lastName":"Probe","password":"NebulaProbe123\!","confirmation":"signup","appType":"developerPortal"\}\}' \-\-max\-time 15<br>**Description:** Test signup API endpoint directly \(VULNERABILITY TEST \- GHSA\-vcwf\-73jp\-r7mv\)<br>**Expected:** 400 with captcha/challenge error = VULNERABLE \(API active despite UI disabled\) 404 = NOT vulnerable \(API disabled\) 200/201 = CRITICAL \- signup succeeded\! 409 = VULNERABLE \(conflict/duplicate\)<br>**Actual:** ASSESSMENT: VULNERABLE \- Signup API is ACTIVE \(captcha validation response\) Status: 400 Response: \{"code":"ValidationError","message":"Captcha challenge validation failed\.","details":\[\{"target":"Captcha","message":"Captcha validation failed\. The captcha challenge has timed\-out, please try again\."\}\]\}<br>**Exit Code:** 400 |

### Triage Guide

```
Vulnerability Overview:
This check identifies APIM instances vulnerable to GHSA-vcwf-73jp-r7mv - a cross-tenant signup bypass
that allows attackers to register accounts even when administrators have disabled signup in the portal UI.
Microsoft considers this behavior "by design" and has not patched it.

Root Cause:
- Disabling signup only hides the form in the portal UI
- The underlying signup API endpoint (/signup) remains active and accepts registration requests
- The signup API does not validate that requests originate from the same tenant's portal
- Attackers can craft requests from any source to register on any vulnerable instance

Attack Vector:
1. Attacker accesses their own APIM Developer Portal (or any with signup enabled)
2. Attacker fills in the signup form and intercepts the request
3. Attacker changes the Host header to the target instance
4. Account is created on the target despite signup being "disabled"

Vulnerable Configuration:
- Developer Portal is Enabled (properties.developerPortalStatus == 'Enabled')
- Signup API endpoint is active (tested by enricher)
- Non-Consumption SKU tier (Consumption has limited portal features)

NOT Vulnerable If:
- Developer Portal is completely disabled
- Signup API endpoint returns HTTP 404 (disabled)

Note: Identity provider configuration (Basic Auth vs Azure AD) does NOT affect this vulnerability.
The signup API works regardless of which authentication methods are configured.

Impact:
- Cross-tenant account creation on any APIM instance with Basic Auth
- Bypass of administrative signup restrictions
- Access to API documentation that may contain sensitive information
- Potential to request API subscription keys
- External attackers can register on "internal" portals

Triage Steps:
1. Review the enrichment output - it tests the signup API endpoint directly
2. If signup API responds with captcha/validation errors, the instance IS VULNERABLE
3. Check if signup is intentionally enabled (attack source) vs disabled in UI (bypass target)
4. Audit existing Developer Portal user accounts for unauthorized signups

Remediation:
Simply disabling signup in the Azure Portal UI is NOT sufficient! The signup API remains active.

1. DISABLE the Developer Portal completely if not needed:
   - Navigate to APIM instance -> Developer Portal -> Portal Overview
   - Disable the entire Developer Portal feature
2. OR verify signup API is truly disabled:
   - Test POST to {developerPortalUrl}/signup
   - Must return HTTP 404 (not 400 with validation errors)
3. Audit all existing Developer Portal accounts for unauthorized signups
4. Review user creation logs for API-based (non-UI) registrations
5. Consider migrating to Azure AD authentication and restricting signup to specific domains

Note: Removing identity providers alone does NOT fix this issue. The signup API must be disabled.

```

### References

- https://github.com/bountyyfi/Azure-APIM-Cross-Tenant-Signup-Bypass/security/advisories/GHSA-vcwf-73jp-r7mv

---

## Publicly Accessible App Services

**Description:** Detects App Services that are publicly accessible from the internet without private endpoints or IP restrictions. Note that VNet integration provides outbound connectivity but does not restrict inbound public access.

**Severity:** Medium

**Template ID:** app_services_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| func\-test\-770646273 | microsoft\.web/sites | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccess: Enabled<br>hasPrivateEndpoint: 0<br>isPubliclyAccessible: 1<br>hasIpRestrictions: 0<br>vnetIntegration: <nil\><br>resourceGroup: rg\-test\-storage | **Command:** curl \-i \-L 'https://func\-test\-770646273\.azurewebsites\.net' \-\-max\-time 10<br>**Description:** Test HTTP GET to App Service default page<br>**Expected:** 200 = accessible \| 401/403 = authentication required \| 404 = not found but accessible \| 503 = app stopped/error<br>**Actual:** Body: <\!DOCTYPE html\> <html\> <head\> <title\>Your Azure Function App is up and running\.</title\> <style type="text/css"\> @font\-face \{ font\-family: 'SegoeLight'; src: url\(//:\) format\('no404'\), url\(data:font/woff;charset=utf\-8;base64,d09GRgABAAAAAFbcABAAAAAAjewAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABbAAAABsAAAAcWqtaPUdERUYAAAGIAAAAHQAAACABGAADT1MvMgAAAagAAABYAAAAYGrqcLZjbWFwAAACAAAAAaIAAAIKczqUA2N2dCAAAAOkAAAATAAAAEwOEAwRZnBnbQAAA/AAAAGxAAACZQ\+0L6dnYXNwAAAFpAAAAAwAAAAMAAMAB2dseWYAAAWwAABJAAAAe3CDYeDNaGVhZAAATrAAAAAxAAAANvjlJxhoaGVhAABO5AAAACAAAAAkDm4GkWhtdHgAAE8EAAACNgAAA6yU7F4gbG9jYQAAUTwAAAHOAAAB2DtSXCptYXhwAABTDAAAACAAAAAgAg8B1G5hbWUAAFMsAAAA5wAAAZ4hIT5EcG9zdAAAVBQAAAH4AAAC\+Je8aS1wcmVwAABWDAAAAM8AAAFulHbF13jaY2BgYGQAguP/NtwH0SfDQtZA6Y0AWbsHmQB42mNgZGBg4ANiCQYQYGIA8V8BSRYwjwEADksBHAAAAHjaY2BmfsOow8DKwMI6i9WYgYFhBYRmkmZIY0rjYGLiZmZiYWVhYmJewMC03oFBIZoBCnyDFRSAlMJvFra0f2kMDOzpTJxAgfkgORYG1lkgOQZGAGSzDHF42mNgYGBmgGAZBkYgycDIAuQxgvksDC\+AtBmDA\.\.\.<br>**Exit Code:** 200<br><br>**Command:** curl \-i 'https://func\-test\-770646273\.scm\.azurewebsites\.net' \-\-max\-time 10<br>**Description:** Test access to SCM/Kudu management site<br>**Expected:** 200 = SCM accessible \(high risk\) \| 401/403 = authentication required \| timeout = blocked<br>**Actual:** Body:<br>**Exit Code:** 401 |
| webapp\-test\-770647162 | microsoft\.web/sites | westus2 | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | resourceGroup: rg\-test\-storage<br>publicNetworkAccess: Enabled<br>hasPrivateEndpoint: 0<br>hasIpRestrictions: 0<br>isPubliclyAccessible: 1<br>vnetIntegration: <nil\> | **Command:** curl \-i \-L 'https://webapp\-test\-770647162\.azurewebsites\.net' \-\-max\-time 10<br>**Description:** Test HTTP GET to App Service default page<br>**Expected:** 200 = accessible \| 401/403 = authentication required \| 404 = not found but accessible \| 503 = app stopped/error<br>**Actual:** Body: ﻿<\!DOCTYPE html\><html lang="en"\><head\><meta charset="utf\-8"/\><meta name="viewport" content="width=device\-width, initial\-scale=1\.0"/\><meta http\-equiv="X\-UA\-Compatible" content="IE=edge"/\><title\>Microsoft Azure App Service \- Welcome</title\><link rel="shortcut icon" href="https://appservice\.azureedge\.net/images/app\-service/v4/favicon\.ico" type="image/x\-icon"/\><link href="https://appservice\.azureedge\.net/css/app\-service/v4/bootstrap\.min\.css" rel="stylesheet" crossorigin="anonymous"/\><style\>html, body\{height: 100%; background\-color: \#ffffff; color: \#000000; font\-size: 13px;\}\*\{border\-radius: 0 \!important;\}</style\><script src="https://appservice\.azureedge\.net/js/app\-service/v4/loc\.min\.js" crossorigin="anonymous"\></script\><script type="text/javascript"\>window\.onload=function \(\)\{try\{var a=window\.location\.hostname; if \(a\.includes\("\.azurewebsites\.net"\)\)\{a=a\.replace\("\.azurewebsites\.net", ""\)\};var b=document\.getElementById\("depCenterLink"\); b\.setAttribute\("href", b\.getAttribute\("href"\) \+\.\.\.<br>**Exit Code:** 200<br><br>**Command:** curl \-i 'https://webapp\-test\-770647162\.scm\.azurewebsites\.net' \-\-max\-time 10<br>**Description:** Test access to SCM/Kudu management site<br>**Expected:** 200 = SCM accessible \(high risk\) \| 401/403 = authentication required \| timeout = blocked<br>**Actual:** Body:<br>**Exit Code:** 401 |

### Triage Guide

```
Important Context:
This scan correctly identifies App Services that are accessible from the internet by checking for the absence of private endpoints and IP restrictions. VNet integration is NOT a factor in determining public accessibility, as it only provides outbound connectivity from the App Service to resources in a virtual network.

Understanding App Service Network Access:
- VNet Integration: Enables OUTBOUND connectivity from App Service to VNet resources (does NOT restrict inbound access)
- Private Endpoints: Provides private inbound connectivity, making the service accessible only from within the VNet
- IP Restrictions: Allows/denies access based on client IP addresses or ranges
- Public Network Access: Controls whether the service accepts connections from public internet

Access Control Mechanisms:
- App Services may implement application-level authentication (Azure AD, built-in authentication)
- Application-level authorization and access controls independent of network configuration
- API keys, authentication tokens, or other application security measures
- Network-level restrictions do not determine application-level security posture

Triage Guidance:
- Test the application from the internet to determine what level of access is actually available
- Browse to the application and attempt any initial access attack vectors
- Review application-level authentication and authorization mechanisms
- Evaluate if the application is intended for public use vs internal use only

Common Scenarios:
- Public-facing websites and APIs legitimately need internet accessibility
- Internal applications may be misconfigured to allow public access
- Development/staging environments may not require the same restrictions as production
- Legacy applications might lack modern authentication mechanisms

Remediation Considerations:
- Implement private endpoints if the application should only be accessible from within Azure
- Configure IP restrictions to limit access to specific networks or IP ranges
- Disable public network access if the application is purely internal
- Implement or strengthen application-level authentication and authorization
- Consider using Azure Front Door or Application Gateway for additional security layers

```

### References

- https://learn.microsoft.com/en-us/azure/app-service/overview-vnet-integration
- https://learn.microsoft.com/en-us/azure/app-service/networking-features
- https://learn.microsoft.com/en-us/azure/app-service/app-service-ip-restrictions
- https://learn.microsoft.com/en-us/azure/app-service/networking/private-endpoint

---

## Publicly Accessible Cosmos DB Accounts

**Description:** Detects Cosmos DB accounts with public network access enabled

**Severity:** High

**Template ID:** cosmos_db_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| cosmos\-test\-770647283 | microsoft\.documentdb/databaseaccounts | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | enableFreeTier: false<br>kind: GlobalDocumentDB<br>ipRules: none<br>publicNetworkAccess: enabled<br>disableLocalAuth: false<br>endpoint: https://cosmos\-test\-770647283\.documents\.azure\.com:443/ | **Command:** curl \-i 'https://cosmos\-test\-770647283\.documents\.azure\.com:443/' \-\-max\-time 10<br>**Description:** Test anonymous access to Cosmos DB discovery endpoint<br>**Expected:** 401/403 = authentication required \| 200 = anonymous access enabled \(misconfiguration\) \| other = connection/network issues<br>**Actual:** Body: \{"code":"Unauthorized","message":"Required Header authorization is missing\. Ensure a valid Authorization token is passed\.\\r\\nActivityId: e5f0599e\-b6ff\-452d\-8b23\-0940c546db48, Microsoft\.Azure\.Documents\.Common/2\.14\.0"\}<br>**Exit Code:** 401 |

### Triage Guide

```
Potential Risk:
- Public accessibility exposes the database endpoint to the entire internet
- Increases risk of brute force attacks and unauthorized access attempts

Triage Guidance:
- This finding only confirms the database is accessible from the internet and not anonymous access
- Additional manual testing is required to determine if anonymous/unauthorized access is possible

```

### References

- https://learn.microsoft.com/en-us/azure/cosmos-db/how-to-configure-firewall

---

## Database Azure Services Access Detection

**Description:** Detects database servers with "Allow Azure services" firewall rules enabled using enrichment analysis

**Severity:** High

**Template ID:** databases_allow_azure_services

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| sql\-test\-770646391 | microsoft\.sql/servers | westus2 | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | resourceGroup: rg\-test\-storage | **Description:** Check SQL Server for AllowAllWindowsAzureIps firewall rule<br>**Actual:** OK: Allow Azure services disabled \- AllowAllWindowsAzureIps rule not found<br>**Exit Code:** 0 |

### Triage Guide

```
This template identifies database resources that may have "Allow Azure services" firewall rules enabled.
Enrichment analysis is performed to detect actual firewall rule configurations:

- SQL Server/Synapse: Checks for AllowAllWindowsAzureIps firewall rule (0.0.0.0-0.0.0.0)
- PostgreSQL Flexible: Checks for AllowAllAzureIps rule + public network access
- MySQL Flexible: Checks for AllowAllAzureIps rule + public network access

**Security Risk**: These rules allow ANY Azure resource from ANY subscription to bypass firewall controls.
**Recommendation**: Use Private Endpoints, VNet service endpoints, or specific IP allowlists instead.

```

### References

- https://learn.microsoft.com/en-us/azure/azure-sql/database/network-access-controls-overview
- https://learn.microsoft.com/en-us/azure/azure-sql/database/firewall-configure
- https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/how-to-manage-firewall-portal
- https://learn.microsoft.com/en-us/azure/mysql/flexible-server/how-to-manage-firewall-portal

---

## Custom Roles with Privilege Escalation Permissions

**Description:** Detects custom role definitions that contain permissions allowing privilege escalation through role assignments, classic administrator changes, or role definition modifications

**Severity:** High

**Template ID:** overprivileged_custom_roles

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| 8667a2e9\-e289\-4b54\-96ea\-36ee334e0fae | microsoft\.authorization/roledefinitions |  | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | assignableScopes: /subscriptions/55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051<br>dangerousAction: \*<br>roleName: Nebula Dangerous Custom Role<br>roleDescription: Extremely dangerous custom role with excessive permissions for testing |  |

### Triage Guide

```
Potential Risk:
- Permissions that allow users to modify role assignments or definitions can lead to privilege escalation
- Users could escalate their own privileges or grant elevated access to others
- Classic Administrator write permissions are especially dangerous as they grant legacy full access

Triage Guidance:
- First check assignableScopes - resource-specific scopes may be acceptable, broad scopes are high risk
- Identify who is currently assigned these roles (users, service principals, managed identities)
- Assess privilege escalation paths and lateral movement opportunities from this position
- Validate in a simulated environment with the same permissions assigned
- Check if role is used in PIM (Privileged Identity Management) for additional controls

```

### References

- https://learn.microsoft.com/en-us/azure/role-based-access-control/custom-roles
- https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

---

## Publicly Accessible Service Bus Namespaces

**Description:** Detects Service Bus namespaces with public network access enabled. Note that all access still requires authentication via SAS tokens or Azure AD, as anonymous access is not supported.

**Severity:** Low

**Template ID:** service_bus_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| sb\-test\-770646729 | microsoft\.servicebus/namespaces | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccess: enabled<br>endpoint: https://sb\-test\-770646729\.servicebus\.windows\.net:443/<br>defaultAction: allow<br>sku: <nil\><br>zoneRedundant: true<br>resourceGroup: rg\-test\-storage | **Command:** curl \-i 'https://sb\-test\-770646729\.servicebus\.windows\.net/$management' \-\-max\-time 10<br>**Description:** Test anonymous access to Service Bus management endpoint<br>**Expected:** 401 = authentication required \| 200 = anonymous access \| 404 = not found<br>**Actual:** Body: <feed xmlns="http://www\.w3\.org/2005/Atom"\><title type="text"\>Publicly Listed Services</title\><subtitle type="text"\>This is the list of publicly\-listed services currently available\.</subtitle\><id\>uuid:f21d1000\-2fc4\-4e2f\-a580\-6e46260c2d4c;id=2856379</id\><updated\>2026\-02\-10T15:39:05Z</updated\><generator\>Service Bus 1\.1</generator\></feed\><br>**Exit Code:** 200<br><br>**Command:** az servicebus namespace network\-rule\-set show \-\-resource\-group rg\-test\-storage \-\-namespace\-name sb\-test\-770646729<br>**Description:** Retrieve Service Bus namespace network rules<br>**Expected:** Network rule configuration with default action and IP/VNet rules<br>**Actual:** \{ "id": "/subscriptions/55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051/resourceGroups/RG\-Test\-Storage/providers/Microsoft\.ServiceBus/namespaces/sb\-test\-770646729/networkrulesets/default", "location": "eastus", "name": "default", "resourceGroup": "RG\-Test\-Storage", "type": "Microsoft\.ServiceBus/namespaces/networkRuleSets", "defaultAction": "Allow", "ipRules": null, "virtualNetworkRules": null, "trustedServiceAccessEnabled": false, "publicNetworkAccess": "Enabled" \}<br>**Exit Code:** 0<br><br>**Command:** az servicebus namespace show \-\-name sb\-test\-770646729 \-\-resource\-group rg\-test\-storage<br>**Description:** Azure CLI command to show Service Bus namespace details<br>**Expected:** Namespace details = accessible via Azure API \| Error = access denied<br>**Actual:** Manual execution required \- requires Azure CLI authentication<br>**Exit Code:** 0 |

### Triage Guide

```
Important Context:
Azure Service Bus queues and topics cannot be accessed anonymously or without authentication. Access to these messaging entities always requires authentication through supported methods, regardless of public network access settings.

Authentication Methods:
- Shared Access Signatures (SAS): Access controlled via shared access policies that produce time-limited SAS tokens with specific permissions (send, listen, manage)
- Microsoft Entra ID (Azure AD): Role-based access control (RBAC) enforced via Azure AD identities with granular OAuth 2.0 permissions
- No configuration allows anonymous or unauthenticated access to queues, topics, or subscriptions

Understanding Public Network Access:
- "Public network access" refers to network-level connectivity from the internet, not authentication bypass
- All messaging operations still require valid SAS tokens or Azure AD authentication

Potential Considerations:
- Increased attack surface through internet-accessible messaging endpoints
- Potential for exposed credentials to be used to authenticate to the messaging endpoints
- Network-level exposure may facilitate reconnaissance of messaging infrastructure

Triage Guidance:
- Validate any mitigating controls (e.g., IP restrictions or network security groups protecting the namespace)

Remediation Considerations:
- Disable public network access if not required for business operations
- Implement private endpoints for secure connectivity from Azure resources
- Configure IP firewall rules if public access is necessary

```

### References

- https://learn.microsoft.com/en-us/azure/service-bus-messaging/network-security
- https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-authentication-and-authorization
- https://learn.microsoft.com/en-us/azure/service-bus-messaging/private-link-service

---

## SQL Servers Without Public Access Block

**Description:** Detects SQL servers with public network access enabled

**Severity:** High

**Template ID:** sql_servers_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| sql\-test\-770646391 | microsoft\.sql/servers | westus2 | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccess: enabled<br>resourceGroup: rg\-test\-storage | **Command:** nc \-zv sql\-test\-770646391\.database\.windows\.net 1433<br>**Description:** Test TCP connectivity to SQL Server port 1433<br>**Expected:** Connection succeeded = accessible \| Connection failed/timeout = blocked/firewall rules active<br>**Actual:** Connection successful \- SQL Server port is accessible<br>**Exit Code:** 0<br><br>**Command:** sqlcmd \-S sql\-test\-770646391\.database\.windows\.net \-U <USERNAME\> \-P '<PASSWORD\>' \-Q 'SELECT @@VERSION' \-l 10<br>**Description:** Test SQL connection with credentials '<USERNAME\>:<PASSWORD\>'<br>**Expected:** Version info = authentication successful \| Login failed = invalid credentials \| Connection failed = network/access issue<br>**Actual:** Manual execution required \- requires sqlcmd tool<br>**Exit Code:** 0<br><br>**Command:** az sql server firewall\-rule list \-\-resource\-group rg\-test\-storage \-\-server sql\-test\-770646391<br>**Description:** Retrieve SQL Server firewall rules<br>**Expected:** List of firewall rules with names and IP address ranges<br>**Actual:** \[\]<br>**Exit Code:** 0 |

### Triage Guide

```
Firewall rules are automatically retrieved and displayed in the `Automated Triage` column above.

Additional manual verification is required:

1. Check for "Allow Azure services and resources to access this server" as that allows firewall bypass (see references for Praetorian blogpost - Solely Relying on Azure Portal and Not Consulting Azure Documentation).
    az sql server firewall-rule list --resource-group <resource-group-name> --server <server-name> --query "[?name=='AllowAllWindowsAzureIps']"

2. Review firewall rules in the Automated Triage column or manually check using Azure CLI:
   az sql server firewall-rule list --resource-group <resourceGroup> --server <serverName>

3. Look for rules that indicate public access:
   - Rules with startIpAddress='0.0.0.0' and endIpAddress='255.255.255.255'
   - Rules that allow a wide public range (/16)
   - The entire corporate IP address range is not recommended, should be using a bastion host or JIT access
   - Single public IP addresses (/32) are generally fine unless it's a developer PC

```

### References

- https://learn.microsoft.com/en-us/azure/azure-sql/database/network-access-controls
- https://www.praetorian.com/blog/migrating-to-azure/

---

## Publicly Accessible Container Registries

**Description:** Detects container registries with public network access enabled

**Severity:** High

**Template ID:** container_registries_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| nebulatestpublic37762 | microsoft\.containerregistry/registries | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccess: enabled<br>adminUserEnabled: false<br>allowAnonymousPull: true<br>sku: <nil\><br>loginServer: nebulatestpublic37762\.azurecr\.io | **Command:** TOKEN=$\(echo \-en 'https://nebulatestpublic37762\.azurecr\.io/oauth2/token?service=nebulatestpublic37762\.azurecr\.io&scope=registry:catalog:\*' \| xargs curl \-s \| jq \-r \.access\_token\); curl \-H 'Authorization: Bearer '$TOKEN 'https://nebulatestpublic37762\.azurecr\.io/v2/\_catalog'<br>**Description:** Test anonymous OAuth2 token \+ repository catalog access \(definitive anonymous pull test\)<br>**Expected:** Success with repositories list = anonymous pull enabled \| Token failure = anonymous access disabled \| 401/403 = secured<br>**Actual:** ✓ ANONYMOUS ACCESS CONFIRMED \| Repositories: \{"repositories":null\}<br>**Exit Code:** 200<br><br>**Command:** docker pull nebulatestpublic37762\.azurecr\.io/\[REPOSITORY\_NAME\]<br>**Description:** Test anonymous Docker pull of repository: \[REPOSITORY\_NAME\]<br>**Expected:** Pull successful = anonymous access enabled \| Authentication required = secured \| Not found = repository doesn't exist<br>**Actual:** Manual execution required \- requires Docker CLI<br>**Exit Code:** 0<br><br>**Command:** az acr show \-\-name nebulatestpublic37762 \-\-query '\{loginServer:loginServer,adminUserEnabled:adminUserEnabled,publicNetworkAccess:publicNetworkAccess,anonymousPullEnabled:anonymousPullEnabled\}'<br>**Description:** Azure CLI command to check registry configuration \(including anonymous pull setting\)<br>**Expected:** Registry details = accessible via Azure API \| Error = access denied or registry not found<br>**Actual:** Manual execution required \- requires Azure CLI authentication<br>**Exit Code:** 0 |
| nebulatestsecure37762 | microsoft\.containerregistry/registries | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | sku: <nil\><br>adminUserEnabled: false<br>loginServer: nebulatestsecure37762\.azurecr\.io<br>publicNetworkAccess: enabled<br>allowAnonymousPull: false | **Command:** TOKEN=$\(echo \-en 'https://nebulatestsecure37762\.azurecr\.io/oauth2/token?service=nebulatestsecure37762\.azurecr\.io&scope=registry:catalog:\*' \| xargs curl \-s \| jq \-r \.access\_token\); curl \-H 'Authorization: Bearer '$TOKEN 'https://nebulatestsecure37762\.azurecr\.io/v2/\_catalog'<br>**Description:** Test anonymous OAuth2 token \+ repository catalog access \(definitive anonymous pull test\)<br>**Expected:** Success with repositories list = anonymous pull enabled \| Token failure = anonymous access disabled \| 401/403 = secured<br>**Actual:** Anonymous token request failed: token request failed: HTTP 401, \{"errors":\[\{"code":"UNAUTHORIZED","message":"authentication required, visit https://aka\.ms/acr/authorization for more information\. CorrelationId: 39a89f24\-b3a7\-4428\-afde\-11da3d5db5cb"\}\]\}<br>**Exit Code:** 401<br>**Error:** token request failed: HTTP 401, \{"errors":\[\{"code":"UNAUTHORIZED","message":"authentication required, visit https://aka\.ms/acr/authorization for more information\. CorrelationId: 39a89f24\-b3a7\-4428\-afde\-11da3d5db5cb"\}\]\}<br><br>**Command:** docker pull nebulatestsecure37762\.azurecr\.io/\[REPOSITORY\_NAME\]<br>**Description:** Test anonymous Docker pull of repository: \[REPOSITORY\_NAME\]<br>**Expected:** Pull successful = anonymous access enabled \| Authentication required = secured \| Not found = repository doesn't exist<br>**Actual:** Manual execution required \- requires Docker CLI<br>**Exit Code:** 0<br><br>**Command:** az acr show \-\-name nebulatestsecure37762 \-\-query '\{loginServer:loginServer,adminUserEnabled:adminUserEnabled,publicNetworkAccess:publicNetworkAccess,anonymousPullEnabled:anonymousPullEnabled\}'<br>**Description:** Azure CLI command to check registry configuration \(including anonymous pull setting\)<br>**Expected:** Registry details = accessible via Azure API \| Error = access denied or registry not found<br>**Actual:** Manual execution required \- requires Azure CLI authentication<br>**Exit Code:** 0 |
| acrtest770646224 | microsoft\.containerregistry/registries | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccess: enabled<br>adminUserEnabled: false<br>sku: <nil\><br>allowAnonymousPull: false<br>loginServer: acrtest770646224\.azurecr\.io | **Command:** TOKEN=$\(echo \-en 'https://acrtest770646224\.azurecr\.io/oauth2/token?service=acrtest770646224\.azurecr\.io&scope=registry:catalog:\*' \| xargs curl \-s \| jq \-r \.access\_token\); curl \-H 'Authorization: Bearer '$TOKEN 'https://acrtest770646224\.azurecr\.io/v2/\_catalog'<br>**Description:** Test anonymous OAuth2 token \+ repository catalog access \(definitive anonymous pull test\)<br>**Expected:** Success with repositories list = anonymous pull enabled \| Token failure = anonymous access disabled \| 401/403 = secured<br>**Actual:** Anonymous token request failed: token request failed: HTTP 401, \{"errors":\[\{"code":"UNAUTHORIZED","message":"authentication required, visit https://aka\.ms/acr/authorization for more information\. CorrelationId: 5243d2b0\-29bd\-4df1\-ba0f\-302f20b52951"\}\]\}<br>**Exit Code:** 401<br>**Error:** token request failed: HTTP 401, \{"errors":\[\{"code":"UNAUTHORIZED","message":"authentication required, visit https://aka\.ms/acr/authorization for more information\. CorrelationId: 5243d2b0\-29bd\-4df1\-ba0f\-302f20b52951"\}\]\}<br><br>**Command:** docker pull acrtest770646224\.azurecr\.io/\[REPOSITORY\_NAME\]<br>**Description:** Test anonymous Docker pull of repository: \[REPOSITORY\_NAME\]<br>**Expected:** Pull successful = anonymous access enabled \| Authentication required = secured \| Not found = repository doesn't exist<br>**Actual:** Manual execution required \- requires Docker CLI<br>**Exit Code:** 0<br><br>**Command:** az acr show \-\-name acrtest770646224 \-\-query '\{loginServer:loginServer,adminUserEnabled:adminUserEnabled,publicNetworkAccess:publicNetworkAccess,anonymousPullEnabled:anonymousPullEnabled\}'<br>**Description:** Azure CLI command to check registry configuration \(including anonymous pull setting\)<br>**Expected:** Registry details = accessible via Azure API \| Error = access denied or registry not found<br>**Actual:** Manual execution required \- requires Azure CLI authentication<br>**Exit Code:** 0 |

### Triage Guide

```
Potential Risk:
- Public accessibility may allow container image pulls from anywhere on the internet
- Could lead to excessive data transfer costs from unauthorized pulls
- May expose sensitive information if images contain secrets or proprietary code

Triage Guidance:
- This finding only confirms the registry is accessible from the internet not anonymous access
- Additional manual testing is required to determine if anonymous/unauthorized access is possible

```

### References

- https://learn.microsoft.com/en-us/azure/container-registry/container-registry-access-selected-networks

---

## Publicly Accessible Event Hub Namespaces

**Description:** Detects Event Hub namespaces with public network access enabled and permissive network rules

**Severity:** High

**Template ID:** event_hub_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| eh\-test\-770646676 | microsoft\.eventhub/namespaces | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | zoneRedundant: true<br>sku: <nil\><br>endpoint: https://eh\-test\-770646676\.servicebus\.windows\.net:443/<br>resourceGroup: rg\-test\-storage<br>publicNetworkAccess: enabled<br>defaultAction: allow | **Command:** curl \-i 'https://eh\-test\-770646676\.servicebus\.windows\.net/$management' \-\-max\-time 10<br>**Description:** Test anonymous access to Event Hub management endpoint<br>**Expected:** 401 = authentication required \| 200 = anonymous access \(misconfiguration\) \| 404 = not found<br>**Actual:** Body: <feed xmlns="http://www\.w3\.org/2005/Atom"\><title type="text"\>Publicly Listed Services</title\><subtitle type="text"\>This is the list of publicly\-listed services currently available\.</subtitle\><id\>uuid:52b57dae\-405e\-40aa\-80d0\-b37344f14ef9;id=56525</id\><updated\>2026\-02\-10T15:38:53Z</updated\><generator\>Service Bus 1\.1</generator\></feed\><br>**Exit Code:** 200<br><br>**Command:** az eventhubs namespace network\-rule\-set list \-\-resource\-group rg\-test\-storage \-\-namespace\-name eh\-test\-770646676<br>**Description:** Retrieve Event Hub namespace network rules<br>**Expected:** Network rule configuration with default action and IP/VNet rules<br>**Actual:** \{ "id": "/subscriptions/55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051/resourceGroups/RG\-Test\-Storage/providers/Microsoft\.EventHub/namespaces/eh\-test\-770646676/networkrulesets/default", "location": "eastus", "name": "default", "resourceGroup": "RG\-Test\-Storage", "type": "Microsoft\.EventHub/namespaces/networkRuleSets", "defaultAction": "Allow", "ipRules": null, "virtualNetworkRules": null, "trustedServiceAccessEnabled": false \}<br>**Exit Code:** 0 |

### Triage Guide

```
Potential Risk:
- Public accessibility exposes messaging endpoints to the entire internet
- Could lead to unauthorized message interception or injection attempts
- May impact service performance from processing unauthorized requests (DoS)
- Sensitive data could be exposed if authentication is misconfigured

Triage Guidance:
- This finding confirms the event hub namespace is accessible from the internet and not anonymous access
- Additional manual testing is required to determine if anonymous/unauthorized access is possible
- Review configured authentication mechanisms and shared access policies

```

### References

- https://learn.microsoft.com/en-us/azure/event-hubs/network-security
- https://learn.microsoft.com/en-us/azure/event-hubs/event-hubs-ip-filtering

---

## Publicly Accessible Key Vaults

**Description:** Detects Key Vault instances with public network access enabled and permissive network rules

**Severity:** High

**Template ID:** key_vault_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| kv\-test\-770646186 | microsoft\.keyvault/vaults | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | bypass: None<br>publicNetworkAccess: enabled<br>sku: standard<br>vaultUri: https://kv\-test\-770646186\.vault\.azure\.net/<br>hasVnetRules: 0<br>defaultAction: allow<br>hasPrivateEndpoints: 0 | **Command:** curl \-i 'https://kv\-test\-770646186\.vault\.azure\.net/keys?api\-version=7\.4' \-\-max\-time 10<br>**Description:** Test Key Vault keys listing endpoint<br>**Expected:** 401 = authentication required \| 200 = anonymous access \(critical issue\) \| 403 = access denied<br>**Actual:** Body: \{"error":\{"code":"Unauthorized","message":"AKV10000: Request is missing a Bearer or PoP token\."\}\}<br>**Exit Code:** 401 |

### Triage Guide

```
No need for additional manual triage, note that this only confirms Internet accessibility not anonymous identity access.

```

### References

- https://learn.microsoft.com/en-us/azure/key-vault/general/network-security

---

## Publicly Accessible Log Analytics Workspaces

**Description:** Detects Log Analytics workspaces with public network access enabled for ingestion or query operations. Note that all access still requires Azure AD authentication and appropriate RBAC permissions.

**Severity:** Low

**Template ID:** log_analytics_public_access

### Findings

| Resource Name | Resource Type | Location | Subscription | Details | Automated Triage |
|---------------|---------------|----------|--------------|---------|------------------|
| DefaultWorkspace\-55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051\-EUS | microsoft\.operationalinsights/workspaces | eastus | 55669d9a\-8cb4\-4761\-b7eb\-0cc2d10b3051 | publicNetworkAccessForIngestion: Enabled<br>publicNetworkAccessForQuery: Enabled |  |

### Triage Guide

```
Important Context:
Azure Log Analytics Workspaces do not support unauthenticated or anonymous access. Every query or API call requires authentication through Azure AD and appropriate permission assignments, regardless of public network access settings. There is no Microsoft-supported configuration to enable unauthenticated access to logs.

Understanding Public Network Access:
- "Public network access" refers to network-level connectivity, not authentication bypass
- All access still requires valid Azure AD authentication and RBAC permissions

Potential Considerations:
- Increased attack surface through internet-accessible endpoints
- Consider whether private endpoints would better align with security posture

Triage Guidance:
- Validate for mitigating controls (e.g., any IP restrictions or network security groups in place)

Remediation Considerations:
- Disable public network access if not required
- Implement private endpoints for secure connectivity
- Configure IP allow lists if public access is necessary
- Review and validate RBAC assignments

```

### References

- https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview
- https://learn.microsoft.com/en-us/azure/azure-monitor/logs/private-link-security
- https://learn.microsoft.com/en-us/azure/azure-monitor/logs/manage-access

---

